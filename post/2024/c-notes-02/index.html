<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://looechao.github.io/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://looechao.github.io/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://looechao.github.io/css/github.min.css' />
    <link rel="stylesheet" href='https://looechao.github.io/css/github-style.css' />
    <link rel="stylesheet" href='https://looechao.github.io/css/light.css' />
    <link rel="stylesheet" href='https://looechao.github.io/css/dark.css' />
    <link rel="stylesheet" href='https://looechao.github.io/css/syntax.css' />
    <title>C语言复习笔记-02 - looechao&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='/images/favicon.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="指针及相关应用" />
<meta name="keywords"
  content='blog, google analytics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://looechao.github.io/post/2024/c-notes-02/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="C语言复习笔记-02 - looechao&#39;s blog" />
<meta name="twitter:description"
  content="指针及相关应用" />
<meta name="twitter:site" content="https://looechao.github.io/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://looechao.github.io/">


<meta property="og:type" content="article" />
<meta property="og:title" content="C语言复习笔记-02 - looechao&#39;s blog">
<meta property="og:description"
  content="指针及相关应用" />
<meta property="og:url" content="https://looechao.github.io/post/2024/c-notes-02/" />
<meta property="og:site_name" content="C语言复习笔记-02" />
<meta property="og:image"
  content="https://looechao.github.io/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2024-05-03 15:38:13 &#43;0800 CST" />











</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://looechao.github.io/">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button" onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search" class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get" autocomplete="off">
            <label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text" class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://looechao.github.io/">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="site:https://looechao.github.io/">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16" version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  
<div>
  <main>
    <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-lg-4 "> 
                <div class="repohead-details-container clearfix container-lg p-responsive d-lg-block"> 
                    <div class="d-flex">
                        <h1 class="public css-truncate float-none flex-auto width-fit pl-0">
                            <a class="avatar mr-1" href="https://looechao.github.io/">
                            
                                <img src="/images/profile.png" class="avatar-user" width="26" height="26" title="Looe">
                            
                            </a>
                            
                            <strong itemprop="name"><a href="https://looechao.github.io/post/2024/c-notes-02/">C语言复习笔记-02</a></strong>

                            

                            
                            <div class="d-block text-small text-gray">
                                <span class="d-inline-block">
                                    Created at <time datetime="2024-05-03 15:38" class="no-wrap">
                                        2024-05-03 15:38</time>
                                </span>

                                
                                </span>
                            </div>
                        </h1>
                    </div>
                </div>
            </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      6466 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/%E6%8A%80%E6%9C%AF">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      技术
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/c/c&#43;&#43;">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      C/C&#43;&#43;
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="指针及应用">指针及应用</h1>
<h2 id="指针基础">指针基础</h2>
<h3 id="概念">概念</h3>
<ul>
<li>地址： 计算机最小的寻址单位 - 字节</li>
<li>变量的地址：变量首字节的地址</li>
<li>指针：地址</li>
<li>指针变量：存储地址值的变量</li>
</ul>
<h3 id="语法">语法</h3>
<h4 id="声明">声明</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="n">p</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>变量名：p</li>
<li>类型:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span>
</span></span></code></pre></div><ul>
<li>注意事项：
声明指针变量时，要制定它指向的对象的类型
类型
<ul>
<li>内存大小</li>
<li>怎么解释它指向的那片内存空间</li>
</ul>
</li>
</ul>
<h4 id="两个基本操作">两个基本操作</h4>
<ul>
<li>取地址： &amp; —— &amp;i</li>
<li>解引用： * —— int* p = &amp;i;
*p有什么意义：
<ul>
<li>指针变量指向对象的别名</li>
<li>间接引用：访问内存两次</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="特殊指针">特殊指针</h3>
<ul>
<li>
<p>野指针：不知道指向哪个对象的指针（eg.选空指针）</p>
<ul>
<li>形式</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="mh">0xCAFEBABE</span><span class="p">;</span>  <span class="c1">//用整数给其赋值
</span></span></span></code></pre></div></li>
<li>
<p>空指针：不指向任何对象的指针 —— NULL；</p>
</li>
</ul>
<p><strong>不能对野指针和空指针进行解引用</strong>，对野指针进行解引用操作是未定义行为，空指针没有指向变量；</p>
<h3 id="给指针变量赋值">给指针变量赋值</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//A.取地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//B.用另一个指针赋值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span><span class="o">*</span> <span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="c1">//p,q 指向同一个对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">*</span><span class="n">q</span>  <span class="c1">//使指向的变量相同
</span></span></span><span class="line"><span class="cl"><span class="c1">//C.使用空指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span> 
</span></span></code></pre></div><h2 id="指针的应用">指针的应用</h2>
<ul>
<li>作为参数使用：
<ul>
<li>在被调函数中修改主调函数的值</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">p1</span><span class="p">,</span> <span class="kt">int</span><span class="o">*</span> <span class="n">p2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="o">*</span><span class="n">p1</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="n">p1</span> <span class="o">=</span> <span class="o">*</span><span class="n">p2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="o">*</span><span class="n">p2</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;a = %d, b = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;a = %d, b = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>指针作为返回值</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">foo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;*p = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;*p = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*p <span class="o">=</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">*p <span class="o">=</span> -8598993460
</span></span></code></pre></div><p>结论（教训）：<strong>不要返回指向当前栈帧的指针</strong></p>
<h2 id="常量指针-和-指针常量">常量指针 和 指针常量</h2>
<p>本质：限制指针变量的写权限</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">表达式</th>
          <th style="text-align: center">p代指的内存</th>
          <th style="text-align: center">i代指的内存</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">int* p = &amp;i</td>
          <td style="text-align: center">r/w</td>
          <td style="text-align: center">r/w</td>
      </tr>
      <tr>
          <td style="text-align: left">int* const p = &amp;i</td>
          <td style="text-align: center">r</td>
          <td style="text-align: center">r/w</td>
      </tr>
      <tr>
          <td style="text-align: left">const int* p = &amp;i</td>
          <td style="text-align: center">r/w</td>
          <td style="text-align: center">r</td>
      </tr>
      <tr>
          <td style="text-align: left">const int* const p = &amp;i</td>
          <td style="text-align: center">r</td>
          <td style="text-align: center">r</td>
      </tr>
  </tbody>
</table>
<h3 id="常量指针">常量指针</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>const限制导致指针指向的值不能修改</li>
<li>可以修改路径, 即可以让指针指向别的元素空间</li>
</ul>
<h3 id="指针常量">指针常量</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="k">const</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>const限制了指针的路径的修改</li>
<li>可以修改指针指向的值</li>
</ul>
<h3 id="传入参数和传出参数">传入参数和传出参数</h3>
<ul>
<li>const int* p
<ul>
<li>传入参数，在函数里面不通过指针变量修改指向的对象</li>
</ul>
</li>
<li>int *p
<ul>
<li>传出参数，在函数里面可以通过指针变量修改指针指向的对象</li>
</ul>
</li>
</ul>
<h2 id="指针的运算">指针的运算</h2>
<h3 id="指针的算术运算">指针的算术运算</h3>
<p>注意：<strong>指针不是整数</strong></p>
<ol>
<li>
<p>指针加上一个整数，结果仍然是一个指针</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">+</span><span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;*p = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>
</span></span></code></pre></div></li>
<li>
<p>指针减去一个整数，结果仍然是一个指针</p>
</li>
<li>
<p>两个指针相减，结果是一个整数，类型变了</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">q</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;p - q = %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;q - p = %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">q</span> <span class="o">-</span> <span class="n">p</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">p - <span class="nv">q</span> <span class="o">=</span> <span class="m">6</span>
</span></span><span class="line"><span class="cl">q - <span class="nv">p</span> <span class="o">=</span> -6
</span></span></code></pre></div><p>表示相隔的单位数量</p>
<h3 id="逻辑运算">逻辑运算</h3>
<ul>
<li>指针支持比较运算</li>
</ul>
<h2 id="指针和数组的关系">指针和数组的关系</h2>
<h3 id="1-用指针可以处理数组">1. 用指针可以处理数组</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span> <span class="n">p</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">sum</span> <span class="o">+=</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;sum = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">sum</span><span class="o">+=</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="和---的组合">*和++ &ndash;的组合</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">	<span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">]){</span>
</span></span><span class="line"><span class="cl">  <span class="n">sum</span> <span class="o">+=</span> <span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="p">;</span>  <span class="c1">//*和++ --的组合
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: center">组合形式</th>
          <th style="text-align: center">表达式值</th>
          <th style="text-align: center">副作用</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">*p++      *(p++)</td>
          <td style="text-align: center">*p</td>
          <td style="text-align: center">p自增</td>
      </tr>
      <tr>
          <td style="text-align: center">(*p)++</td>
          <td style="text-align: center">*p</td>
          <td style="text-align: center">*p自增</td>
      </tr>
      <tr>
          <td style="text-align: center">*++p</td>
          <td style="text-align: center">*(++p)</td>
          <td style="text-align: center">p自增</td>
      </tr>
      <tr>
          <td style="text-align: center">++*p  ++(*p)</td>
          <td style="text-align: center">(*p)+1</td>
          <td style="text-align: center">*p自增</td>
      </tr>
  </tbody>
</table>
<ul>
<li>
<p>每次进行arr[i]时，都会进行加法和乘法运算</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="nv">i_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">base_addr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div></li>
<li>
<p>而使用指针顺序扫描时，只需要进行一次加法运算</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> 
</span></span></span></code></pre></div><p>早期编译器对乘法的优化差，因此常用指针做处理</p>
</li>
</ul>
<h3 id="2-数组可以退化为指针">2. 数组可以退化为指针</h3>
<ol>
<li>
<p>在必要的时候（例如作为参数时），数组可以退化成指向它索引为0的元素的指针</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span> <span class="n">p</span><span class="o">&lt;</span> <span class="n">arr</span><span class="o">+</span><span class="mi">10</span><span class="p">;</span> <span class="n">p</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">sum</span> <span class="o">+=</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>数组在赋值表达式的右边时，会退化成指针</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>数组参与算术运算的时候，也会退化成指针</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">arr</span><span class="o">+</span><span class="mi">3</span><span class="p">;</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="3-指针也支持取下标运算">3. 指针也支持取下标运算</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">arr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">sum</span><span class="o">+=</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>   <span class="c1">//指针取下标运算
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><p>例如数组退化成指针</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define SIZE(a) (sizeof(a)/sizeof(a[0]))
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">// p[i] &lt;=&gt; * (p+i) &lt;=&gt; *(i+p) &lt;=&gt; i[p]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span>  <span class="nf">sum_array</span><span class="p">(</span><span class="kt">int</span> <span class="n">arr</span><span class="p">[];</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>   <span class="c1">//arr的类型时int*
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">sum</span> <span class="o">+</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">arr</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>    <span class="c1">//解引用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">sum</span> <span class="o">+</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="n">arr</span><span class="p">];</span>    <span class="c1">//防御式编程
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">sum</span> <span class="o">+</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>   <span class="c1">//与上式效果一样
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="字符串">字符串</h1>
<h2 id="总纲">总纲</h2>
<ul>
<li><strong>C语言没有字符串类型</strong>（没有String）</li>
<li>C语言中的字符串依赖在字符数组存在</li>
<li>C语言中的字符串是一种“逻辑类型”
<table>
  <thead>
      <tr>
          <th style="text-align: center">h</th>
          <th style="text-align: center">e</th>
          <th style="text-align: center">l</th>
          <th style="text-align: center">l</th>
          <th style="text-align: center">o</th>
          <th style="text-align: center">\</th>
          <th style="text-align: center">0</th>
          <th style="text-align: center">w</th>
          <th style="text-align: center">o</th>
          <th style="text-align: center">r</th>
          <th style="text-align: center">l</th>
          <th style="text-align: center">d</th>
          <th style="text-align: center">\</th>
          <th style="text-align: center">n</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</li>
</ul>
<p>该字符串是hello，因为后一位是\0空字符标志着结束</p>
<h2 id="字符串字面值">字符串字面值</h2>
<p>字面值：“hello world” ，写死在括号里的是字面值</p>
<h3 id="三种书写方式">三种书写方式</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;I love xixi  -- From looe</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;I love xixi  \
</span></span></span><span class="line"><span class="cl"><span class="s">         -- From looe</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;I love xixi&#34;</span>  
</span></span><span class="line"><span class="cl">         <span class="s">&#34;-- From looe</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>效果：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">I love xixi -- From looe
</span></span><span class="line"><span class="cl">I love xixi        -- From looe
</span></span><span class="line"><span class="cl">I love xixi -- From looe
</span></span></code></pre></div><p>可以应用在打印图形上</p>
<ul>
<li>注意区分常量和字面值</li>
</ul>
<h3 id="内存模式">内存模式</h3>
<p>在内存中的代码段中，是不能够修改的，以空字符结尾</p>
<ul>
<li>扩展-各种&rsquo;空'
<table>
  <thead>
      <tr>
          <th style="text-align: center">名称</th>
          <th style="text-align: center">类型</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">void</td>
          <td style="text-align: center">空类型</td>
      </tr>
      <tr>
          <td style="text-align: center">\0</td>
          <td style="text-align: center">空字符</td>
      </tr>
      <tr>
          <td style="text-align: center">NULL</td>
          <td style="text-align: center">空指针</td>
      </tr>
      <tr>
          <td style="text-align: center">“ ”</td>
          <td style="text-align: center">空字符串</td>
      </tr>
  </tbody>
</table>
</li>
</ul>
<h3 id="操作">操作</h3>
<ul>
<li>
<p>常量数组能支持的操作，字符串字面值都支持</p>
<p>eg1.  指针思维</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="s">&#34;ABC&#34;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="s">&#34;ABC&#34;</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//指向B
</span></span></span></code></pre></div><p>result</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">B
</span></span></code></pre></div><p>将“ABC”看成一个数组名</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;abc&#34;</span><span class="p">);</span>  <span class="c1">//传入的其实是数组&#34;abc&#34;的地址
</span></span></span></code></pre></div><p>eg2. 字面值的灵活应用</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//数字转换成16进制
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span> <span class="nf">digit_to_hex</span><span class="p">(</span><span class="kt">int</span> <span class="n">digit</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="s">&#34;0123456789ABCDEF&#34;</span><span class="p">[</span><span class="n">digit</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="字符串变量">字符串变量</h2>
<h3 id="声明和初始化">声明和初始化</h3>
<ol>
<li>初始化字符数组</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">str1</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;h&#39;</span><span class="p">,</span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="sc">&#39;\0&#39;</span><span class="p">};</span> <span class="c1">//数组的初始化
</span></span></span></code></pre></div><p>上例字符串的长度是5，字符数组长度为10；</p>
<ol start="2">
<li>初始化字符串</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">str2</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello&#34;</span><span class="p">;</span>  <span class="c1">//语法糖，这里的&#34;hello&#34;是字符串数组初始化的简写形式
</span></span></span></code></pre></div><ul>
<li>
<p>长度问题：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"> <span class="kt">char</span> <span class="n">str</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;hello&#34;</span><span class="p">;</span>  <span class="c1">//长度为6，表示字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;hello&#34;</span><span class="p">;</span> <span class="c1">//长度为5，不表示字符串
</span></span></span></code></pre></div></li>
<li>
<p>注意事项</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">str</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;hello&#34;</span><span class="p">;</span>  <span class="c1">//&#34;hello&#34;:数组的初始化式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="s">&#34;hello&#34;</span><span class="p">;</span>    <span class="c1">//“hello”:字符串字面值
</span></span></span></code></pre></div></li>
</ul>
<h3 id="读和写操作和用户交互">读和写操作（和用户交互）</h3>
<p>常用%s对字符串进行读写操作</p>
<ul>
<li>
<p>写操作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">str</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello world&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s.5</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>   <span class="c1">//%s.p 最多输出p个字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">puts</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span></code></pre></div><p>result</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Hello world
</span></span><span class="line"><span class="cl">Hello
</span></span><span class="line"><span class="cl">Hello world
</span></span></code></pre></div><p>puts(str)，等价于 printf(&quot;%s\n&quot;,str)  但是puts效率更高</p>
</li>
<li>
<p>读操作，匹配规则</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define MAX_LEN 128
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="n">MAX_LEN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>  <span class="c1">//数组不需要加取地址运算符，会忽略前置空白字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><p>result:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">D:<span class="se">\h</span>ome<span class="se">\ </span>  hello world
</span></span><span class="line"><span class="cl">hello
</span></span></code></pre></div><p>%s的匹配规则：</p>
<p>常用于读取一个单词</p>
<ul>
<li>
<p>忽略前置的空白字符</p>
</li>
<li>
<p>遇到空的字符结束</p>
</li>
</ul>
<p>缺点：</p>
<ol>
<li>不能存储空白字符</li>
<li>不会检查数组越界，很容易输入过多超过下标</li>
</ol>
</li>
<li>
<p>gets对字符串进行读写操作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="n">MAX_LEN</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;Hello world&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">gets</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>  <span class="c1">//读取一行数据，存入字符数组，并将换行符替换成空字符，不会检查越界
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nf">fgets</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">MAX_LNE</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span> <span class="c1">//和gets相比，会检查数组是否越界，会存储换行符，并在后面添加空字符
</span></span></span></code></pre></div></li>
</ul>
<h3 id="常用操作">常用操作</h3>
<ul>
<li>strlen</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nf">strlen</span><span class="p">(</span><span class="s">&#34;ABC&#34;</span><span class="p">)</span> <span class="c1">//结果是3，不会计算空字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">p</span> <span class="o">-</span> <span class="n">s</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>strcpy &amp; strncpy</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">cahr</span> <span class="n">s1</span><span class="p">[</span><span class="n">MAX_LEN</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nf">strcpy</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="s">&#34;hello world&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">strncpy</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="s">&#34;helloworld&#34;</span><span class="p">,</span> <span class="n">MAX_LNE</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">s1</span><span class="p">[</span><span class="n">MAXL_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><ul>
<li>
<p>strcat &amp; strncat</p>
</li>
<li>
<p>strcmp
类比于做减法</p>
</li>
<li>
<p>惯用法：</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="o">*</span><span class="n">s1</span><span class="o">++</span> <span class="o">==</span> <span class="o">*</span><span class="n">s2</span><span class="o">++</span><span class="p">);</span>
</span></span></code></pre></div><p><strong>数组只支持取下标操作，不能赋值</strong></p>
<ul>
<li>
<p>注意事项</p>
<ol>
<li>字符串必须以‘\0’空字符结尾</li>
<li>在C语言中iqu字符串的长度不是O(1)的时间复杂度</li>
</ol>
</li>
</ul>
<h2 id="字符串数组">字符串数组</h2>
<h3 id="二维字符数组">二维字符数组</h3>
<p>字符数组的数组</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">planets</span><span class="p">[][]</span> <span class="p">{}</span>
</span></span></code></pre></div><p>特点：</p>
<ul>
<li>可能会浪费内存空间</li>
<li>不灵活</li>
</ul>
<h3 id="字符指针数组">字符指针数组</h3>
<p>字符指针数组，实质上是一维数组
特点：</p>
<ul>
<li>灵活</li>
</ul>
<h2 id="命令行参数">命令行参数</h2>
<h3 id="概念-1">概念</h3>
<ul>
<li>操作系统调用main函数时，传递的参数</li>
</ul>
<h3 id="使用方法">使用方法</h3>
<p>main（<strong>状态码</strong>） → 操作系统； 0成功，非0失败</p>
<p>操作系统（<strong>命令行参数</strong>）→ main</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// argc: argument count,命令行参数的个数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// argv: argument vector,命令行参数，字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 第一个参数，即argv[0]是可执行程序的路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;argc = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//打印所有的命令行参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">puts</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">//命令行参数的转换
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//xxx.exe n f
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//argv[0] argv[1] argv[2]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">float</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">sscanf</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sscanf</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s">&#34;%lf&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>result:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">argc</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">D:<span class="se">\D</span>ocuments<span class="se">\C</span>oding<span class="se">\w</span>angdao-coding-notebook<span class="se">\s</span>ummer-camp<span class="se">\p</span>ractice<span class="se">\C</span>Day008.c<span class="se">\o</span>utput<span class="se">\p</span>1.exe  
</span></span></code></pre></div><ul>
<li>
<p>命令行参数都是字符串</p>
<ul>
<li>参数的转换：sscanf(&hellip;.);</li>
</ul>
</li>
<li>
<p>命令行参数的转换</p>
</li>
</ul>
<p>​    stdin(字符数据)scanf →程序← sscanf字符串（内存）</p>
<h3 id="两个问题">两个问题</h3>
<ul>
<li>
<p>命令行参数和stdin读取数据有什么区别?</p>
<ul>
<li>命令行参数执行时程序未执行</li>
<li>stdin读取数据程序已经执行</li>
</ul>
</li>
<li>
<p>命令行参数有什么作用?</p>
<ul>
<li>
<p>能够写出非常通用的程序</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp src dst
</span></span></code></pre></div></li>
<li>
<p>改变程序的行为，参数不同，行为不同</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls -l
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h2 id="结构体">结构体</h2>
<h3 id="基础概念">基础概念</h3>
<p>C语言中的结构体，自定义类型，类似于其它语言中的类</p>
<p>特点：C语言中的结构体只有属性，没有方法（可以用函数指针解决这个问题）</p>
<ul>
<li>定义/声明并初始化</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">student</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">gender</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">chinese</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">math</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">english</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//声明并初始化变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">struct</span> <span class="n">student</span> <span class="n">s1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;xixi&#34;</span><span class="p">,</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="mi">100</span><span class="sc">&#39;,&#39;</span><span class="mi">100</span><span class="sc">&#39;,&#39;</span><span class="mi">100</span><span class="err">&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">student</span> <span class="n">s2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#34;peanut&#34;</span><span class="p">,</span> <span class="sc">&#39;M&#39;</span><span class="p">};</span>   <span class="c1">//未指定的成员，会赋0值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="内存模型">内存模型</h3>
<p>结构体内存模型的特点：</p>
<ol>
<li>
<p>一片连续的内存空间</p>
</li>
<li>
<p>会按类型声明的顺序存放每一个成员</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">id(int)</th>
          <th style="text-align: left">name(char)</th>
          <th style="text-align: left">gender(char)</th>
          <th style="text-align: left">chinese(int)</th>
          <th style="text-align: left">math(int)</th>
          <th style="text-align: left">english(int)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">4</td>
          <td style="text-align: left">25</td>
          <td style="text-align: left">1+2</td>
          <td style="text-align: left">4</td>
          <td style="text-align: left">4</td>
          <td style="text-align: left">4</td>
      </tr>
  </tbody>
</table>
</li>
<li>
<p>在结构体变量的中间或者后面，可能会有一些填充</p>
<p>若没有填充，结构体的大小应该是42字节，但结果是44字节，填充部位在gender和chinese之间，填充是为了<strong>内存对齐</strong>；早期的计算机访存时，一次性读4个字节，因此对齐是为了防止访存顿挫（一个对象访存两次）, 提高性能</p>
</li>
</ol>
<h3 id="操作-1">操作</h3>
<h4 id="获取成员">获取成员</h4>
<ul>
<li>.获取成员运算符</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
</span></span></code></pre></div><ul>
<li>语法糖 -&gt;运算符</li>
</ul>
<p>左边是结构体指针,右边是成员</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">);</span> 
</span></span></code></pre></div><p>等价于</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">).</span><span class="n">id</span>
</span></span></code></pre></div><h4 id="赋值">赋值</h4>
<ul>
<li>赋值操作的本质:
内存空间的复制,把s1代指的内存空间复制到s2代指的内从空间</li>
<li>缺点:
当传递或者返回一个结构体时,都会产生一个结构体的复制,耗时,影响程序的性能</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//结构体变量的赋值
</span></span></span><span class="line"><span class="cl"><span class="c1">//更习惯传递一个指向结构体变量的指针，避免整个结构体的复制
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">student</span> <span class="n">s1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">student</span> <span class="n">s2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print_stu_info</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">student</span><span class="o">*</span> <span class="n">s</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,(</span><span class="o">*</span><span class="n">s</span><span class="p">).</span><span class="n">id</span><span class="p">)</span><span class="c1">//注意优先级,*s.id不可用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><h4 id="定义别名">定义别名</h4>
<ul>
<li>匿名结构体: 没有标签的结构体类型</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">gendaer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">;</span>
</span></span></code></pre></div><p>s1, s2 是变量</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">student</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">student</span> <span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">;</span>
</span></span></code></pre></div><p>s1,s2 与eg1相同</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">student</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">Student</span><span class="p">,</span> <span class="o">*</span><span class="n">pStudent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 等价于 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Student</span><span class="o">*</span> <span class="n">pstudent</span><span class="p">;</span>
</span></span></code></pre></div><p>用student 起别名, 用*pStudent作为别名的指针</p>
<ul>
<li>为结构体类型起别名</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// typedef 类型 别名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typedef</span> <span class="k">struct</span> <span class="n">student</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">gender</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">chinese</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">math</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">english</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">Student</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//两种声明对比
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Student</span> <span class="n">s1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;xixi&#34;</span><span class="p">,</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="mi">100</span><span class="sc">&#39;,&#39;</span><span class="mi">100</span><span class="sc">&#39;,&#39;</span><span class="mi">100</span><span class="err">&#39;</span><span class="p">};</span>   <span class="c1">//匿名结构体
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">struct</span> <span class="n">student</span> <span class="n">s1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="s">&#34;penut&#34;</span><span class="p">,</span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="mi">100</span><span class="sc">&#39;,&#39;</span><span class="mi">100</span><span class="sc">&#39;,&#39;</span><span class="mi">100</span><span class="err">&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>注意：<strong>不要给指针类型定义别名</strong></p>
<h3 id="枚举">枚举</h3>
<ul>
<li>
<p>作用: 表示一些离散值(例如 类别 状态), 有提高代码可读性的作用，在底层就是整数；</p>
</li>
<li>
<p>语法</p>
<ul>
<li>
<p>定义枚举类型</p>
</li>
<li>
<p>使用枚举值</p>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">enum</span> <span class="n">suit</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//罗列的是枚举值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">DIAMOND</span><span class="p">,</span>    <span class="c1">// 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">CLUB</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">HEART</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">SPADE</span>       <span class="c1">// 11
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span><span class="n">Suit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">enum</span> <span class="n">Suit</span> <span class="n">suit1</span> <span class="o">=</span> <span class="n">DIAMOND</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//定义别名后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Suit</span> <span class="n">suit1</span> <span class="o">=</span> <span class="n">DIAMOND</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="指针的高级用法">指针的高级用法</h2>
<h3 id="动态内存分配-">动态内存分配 ⭐</h3>
<p>进程的虚拟内存空间, 堆空间的管理常用算法(freelist/伙伴算法)</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center"></th>
          <th style="text-align: center"></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">高地址</td>
          <td style="text-align: center">内核区</td>
      </tr>
      <tr>
          <td style="text-align: center">动态</td>
          <td style="text-align: center"><strong>栈</strong>（管理函数调用）</td>
      </tr>
      <tr>
          <td style="text-align: center">动态</td>
          <td style="text-align: center">↓ ↑</td>
      </tr>
      <tr>
          <td style="text-align: center">动态</td>
          <td style="text-align: center"><strong>堆</strong>（存放动态数据）</td>
      </tr>
      <tr>
          <td style="text-align: center">数据</td>
          <td style="text-align: center"><strong>数据段</strong></td>
      </tr>
      <tr>
          <td style="text-align: center">低地址（指令）</td>
          <td style="text-align: center"><strong>代码段</strong></td>
      </tr>
  </tbody>
</table>
<ul>
<li>
<p>管理堆很麻烦，为什么要在堆中存放动态数据, 而不是在栈中？</p>
<ol>
<li>栈帧的大小是在编译期间就确定的,不能存放动态大小的数据</li>
<li>栈空间是有限的,不能存放很大的数据(主线程: 8M, 其它进程2M), 而堆区常常多达几个GB.</li>
<li>栈空间最好不要放多线程的数据，有可能堆中放的是共享数据，放在栈中容易被释放</li>
</ol>
</li>
<li>
<p>什么是动态大小的数据</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">arr1</span><span class="p">[</span><span class="n">n</span><span class="p">];</span><span class="c1">//动态大小，在运行时才能确定，不存栈里
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">arr2</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="如何申请堆空间">如何申请堆空间</h3>
<h4 id="void---通用指针类型">void* - 通用指针类型</h4>
<ul>
<li>指向对象的类型还不确定， 因此不能够直接操作通用指针（解引用等）</li>
<li>作用： 可以和其它类型指针相互转换</li>
<li>缺点：通用指针不能参与指针的运算（解引用，自增减等）</li>
</ul>
<p>eg.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">++</span><span class="p">;</span>  <span class="c1">//该操作非法，不能对通用指针进行直接操作
</span></span></span></code></pre></div><h4 id="malloc函数">malloc函数</h4>
<p>memory allocate</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="kt">void</span><span class="o">*</span> <span class="nf">malloc</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">);</span>  <span class="c1">//通用指针转换成int*      
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span>   <span class="c1">//判断空间是否申请成功
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error: malloc failed in main.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>   <span class="c1">//p指向的对象不存在
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error: malloc failed in main.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: left">栈帧</th>
          <th style="text-align: center">变量</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">main</td>
          <td style="text-align: center">p ↓</td>
      </tr>
      <tr>
          <td style="text-align: left">堆</td>
          <td style="text-align: center">一串数组（连续空间）</td>
      </tr>
  </tbody>
</table>
<p>​    用栈上的指针访问堆中的数据</p>
<p>​    分配size个字节的内存块</p>
<h4 id="catlloc函数">catlloc函数</h4>
<p>clear + allocate</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">calloc</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="c1">//            元素个数  元素大小
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="realloc函数">realloc函数</h4>
<p>重新分配内存空间</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="nf">realloc</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span> <span class="n">ptr</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//*ptr指向先前分配的内存块
</span></span></span><span class="line"><span class="cl"><span class="c1">//size 指新内存块的大小
</span></span></span></code></pre></div><ul>
<li>
<p>缩容</p>
<p>截断最后的部分，前半部分保持不变</p>
</li>
<li>
<p>扩容</p>
<ol>
<li>原地扩容，不一定成功，而且扩容出来的空间不一定是初始化的</li>
<li>若扩容失败，空间不足，会在堆中重新申请足够大的内存空间，把旧的数据拷贝过去并释放旧的内存块，返回新空间的整体指针</li>
</ol>
</li>
<li>
<p>若申请失败，返回NULL, 并且旧的内存块不会被释放</p>
</li>
</ul>
<h5 id="惯用法">惯用法</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="nf">realloc</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//错误处理
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ptr</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//错误用法,会产生垃圾空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">ptr</span> <span class="o">=</span> <span class="nf">realloc</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="n">size</span><span class="p">);</span>
</span></span></code></pre></div><h4 id="free">free</h4>
<h5 id="分类">分类</h5>
<ul>
<li>垃圾回收器：减轻程序员负担
<ul>
<li>不确定因素 -&gt; stop the world -&gt;不适合写实时系统，必须在某个确定时间内完成某个任务</li>
</ul>
</li>
<li>没有垃圾回收器（C/C++/Rust）
<ul>
<li>C     :    free</li>
<li>C++ :    析构函数/RAII机制/智能指针</li>
<li>Rust:    所有权机制</li>
</ul>
</li>
</ul>
<h5 id="错误用法">错误用法</h5>
<p>两种错误操作</p>
<ol>
<li>double free</li>
<li>use after free</li>
</ol>
<p>结论：<strong>当堆上数据不再使用时，应该有且只释放一次</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//1. double free
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="c1">//该操作不会改变P的值，只会将P指向的内存空间释放出去
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 	<span class="c1">//执行完成上述操作后，p会编程悬空指针（野指针的一种）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="c1">//2. use after free
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>   <span class="c1">//p成为悬空指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">p</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c1">//use after free;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="动态数组">动态数组</h2>
<p>从内存模型开始逐步分析实现一个Vector</p>
<h3 id="内存模型-1">内存模型</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">elements</th>
          <th style="text-align: left">*</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">capacity</td>
          <td style="text-align: left">int</td>
      </tr>
      <tr>
          <td style="text-align: left">size</td>
          <td style="text-align: left">int</td>
      </tr>
  </tbody>
</table>
<h3 id="头文件">头文件</h3>
<p>vector.h</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">typdef</span> <span class="kt">int</span> <span class="n">E</span><span class="p">;</span>   <span class="c1">//增加灵活性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">vector</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">E</span><span class="o">*</span> <span class="n">elements</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">capacity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">Vector</span><span class="p">;</span>
</span></span></code></pre></div><p>方法（API声明）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//构造函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Vector</span><span class="o">*</span> <span class="nf">vector_create</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//析构函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">vector_destroy</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">push_back</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="n">E</span> <span class="n">val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">push_front</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="n">E</span> <span class="n">val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">pop_back</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="n">E</span> <span class="n">val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">pop_front</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="n">E</span> <span class="n">val</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="api实现">API实现</h3>
<p>vector.c</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;Vector.h&#34;  </span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1">//&#34;&#34;搜索路径：当前目录-&gt;系统头文件包含目录下
</span></span></span><span class="line"><span class="cl"><span class="c1">//&lt;&gt;搜索路径：系统头文件包含目录下
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define DEFAULT_CAPACITY 8   </span><span class="c1">//避免频繁扩容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define PREALLOC_MAX 4096 </span><span class="c1">//扩大到的内存空间上限
</span></span></span><span class="line"><span class="cl"><span class="c1">// 创建空的动态数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Vector</span><span class="o">*</span> <span class="nf">vector_create</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">Vector</span><span class="o">*</span> <span class="n">v</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Vector</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">v</span><span class="p">){</span>   <span class="c1">//抛出错误异常
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error: malloc failed in vector_create&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span><span class="o">-&gt;</span><span class="n">elements</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="n">DEFAULT_CAPACITY</span><span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">E</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">v</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">free</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error: malloc failed in vector_create&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">-&gt;</span> <span class="n">capacity</span> <span class="o">=</span> <span class="n">DEFAULT_CAPACITY</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">V</span> <span class="o">-&gt;</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//扩容策略，不算API，用户不需要知道
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">grow_capacity</span><span class="p">(</span><span class="n">Vecot</span> <span class="o">*</span><span class="n">v</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">new_capacity</span> <span class="o">=</span> <span class="n">v</span><span class="o">-&gt;</span><span class="n">capacity</span> <span class="o">&lt;</span> <span class="n">PREALLOC_MAX</span> <span class="o">?</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span><span class="o">-&gt;</span> <span class="n">capacity</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">v</span> <span class="o">-&gt;</span> <span class="n">capacity</span> <span class="o">+</span> <span class="n">PREALLOC_MAX</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// v-&gt;elements = realloc(v-&gt;elemets, new_capacity * sizeof(E));   //错误用法，realloc失败会返回NULL,原来的内存空间不会被释放
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">E</span><span class="o">*</span> <span class="n">temp</span> <span class="o">=</span> <span class="nf">realloc</span><span class="p">(</span><span class="n">v</span><span class="o">-&gt;</span><span class="n">elemets</span><span class="p">,</span> <span class="n">new_capacity</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">E</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">temp</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error: malloc failed in grow_capacity&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    	<span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">-&gt;</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>    <span class="c1">//改变指向的新的结构体
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">v</span> <span class="o">-&gt;</span> <span class="n">capacity</span> <span class="o">=</span> <span class="n">new_capacity</span><span class="p">;</span>   <span class="c1">//更新容量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">push_back</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span> <span class="n">v</span><span class="p">,</span> <span class="n">E</span> <span class="n">val</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//判断是否需要扩容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">==</span> <span class="n">v</span><span class="o">-&gt;</span> <span class="n">capacity</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">grow_capacity</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//添加元素val
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">v</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="n">v</span><span class="o">-&gt;</span><span class="n">size</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>   <span class="c1">//只要更改size就可以
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">vector_destroy</span><span class="p">(</span><span class="n">Vector</span><span class="o">*</span> <span class="n">v</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//原则，要按照申请的相反顺序释放
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">free</span><span class="p">(</span><span class="n">v</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">);</span>   <span class="c1">//悬空函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">free</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="主函数">主函数</h3>
<p>main.c 用于进行单元测试</p>
<ul>
<li>
<p>依赖接口(*.h Interface)，不要依赖实现(.c文件)：</p>
<p>因为接口是稳定的，而实现常常是会变化的、不稳定的</p>
</li>
<li>
<p>依赖关系</p>
<p>main.c -&gt; vector.h（接口:类型定义和API声明）&lt;- vector.c（实现）</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;vector.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//单元测试
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建空的动态数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Vector</span><span class="o">*</span> <span class="n">v</span> <span class="o">=</span> <span class="nf">vector_create</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 添加元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 销毁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">vector_destroy</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="大端法和小端法">大端法和小端法</h3>
<ul>
<li>
<p>大端法：低有效位放在高地址</p>
<ul>
<li>一般英特尔系CPU采用小端法</li>
</ul>
</li>
<li>
<p>小端法：低有效位放在低地址</p>
<ul>
<li>网络里的数据一般采用大端法</li>
<li>spark芯片采用大端法</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="err">值</span><span class="o">-------</span><span class="err">编码</span><span class="o">------&gt;</span> <span class="err">二进制</span><span class="o">-----</span><span class="err">大端法</span><span class="o">/</span><span class="err">小端法</span><span class="o">-----&gt;</span><span class="err">内存存储</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">---</span><span class="err">补码</span><span class="o">---&gt;</span><span class="mh">0x00000001</span><span class="o">---</span><span class="err">大端法</span><span class="o">----&gt;</span><span class="mo">00000001</span><span class="err">（低</span><span class="o">-&gt;</span><span class="err">高）</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">---</span><span class="err">补码</span><span class="o">---&gt;</span><span class="mh">0x00000001</span><span class="o">---</span><span class="err">大端法</span><span class="o">----&gt;</span><span class="mo">01000000</span><span class="err">（低</span><span class="o">-&gt;</span><span class="err">高）</span>
</span></span></code></pre></div><h2 id="链式结构">链式结构</h2>
<h3 id="链表">链表</h3>
<ul>
<li>数据域：存放数据</li>
<li>指针域：存放节点的地址</li>
</ul>
<h4 id="分类-1">分类</h4>
<ul>
<li>
<p>单向链表</p>
<p>最后一个节点的指针是空指针</p>
</li>
<li>
<p>单向循环链表</p>
<p>环形</p>
</li>
<li>
<p>双向链表</p>
<p>首节点的prev指针和尾节点的next指针为空</p>
</li>
<li>
<p>双向循环链表</p>
</li>
</ul>
<h4 id="构建">构建</h4>
<p>声明和初始化</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">node</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">node</span><span class="o">*</span> <span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">Node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//OnePass过程
</span></span></span><span class="line"><span class="cl"><span class="c1">//从头到尾遍历一次，提前使用Node编译器会不认识
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//头插法插入节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Node</span><span class="o">*</span> <span class="nf">addNode</span><span class="p">(</span><span class="n">Node</span><span class="o">*</span> <span class="n">head</span><span class="p">,</span> <span class="kt">int</span> <span class="n">data</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//创建节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Node</span><span class="o">*</span> <span class="n">new_node</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">new_node</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error:malloc failed in addNode.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//初始化节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">new_node</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">new_node</span><span class="o">-&gt;=</span><span class="n">head</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="n">new_node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">head</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="n">Node</span><span class="o">*</span> <span class="n">head</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span> <span class="c1">//空链表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">head</span> <span class="o">=</span> <span class="nf">addNode</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="nf">addNode</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="nf">addNode</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>	
</span></span></code></pre></div><h2 id="二级指针">二级指针</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">     <span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">----------&gt;</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="o">---&gt;</span><span class="p">[</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">ptr2</span>           <span class="n">ptr1</span>    
</span></span><span class="line"><span class="cl"><span class="kt">int</span><span class="o">**</span> <span class="n">ptr2</span>        <span class="kt">int</span><span class="o">*</span> <span class="n">ptr1</span>
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th style="text-align: center">表达式</th>
          <th style="text-align: center">访存次数</th>
          <th style="text-align: center">等价于</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">**ptr2</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">*ptr1</td>
      </tr>
      <tr>
          <td style="text-align: center">*ptr1</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">ptr1</td>
      </tr>
  </tbody>
</table>
<h3 id="使用时的问题">使用时的问题</h3>
<p>QA：传一级指针还是传二级指针？</p>
<p>想修改哪个变量，就传递那个变量的地址</p>
<ul>
<li>想修改指针指向的对象，传递一级指针</li>
<li>想修改指针的指向（值），传递二级指针</li>
</ul>
<h2 id="函数指针">函数指针</h2>
<h3 id="基本概念">基本概念</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">foo</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>函数指针指向函数的起点，在汇编中遇到ret会停止</p>
<ul>
<li>函数指针变量类型的声明</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">   <span class="kt">int</span>   <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span> <span class="c1">//声明指针变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">返回值类型</span>       <span class="err">参数类型</span>    <span class="c1">//foo, &amp;foo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="kt">int</span><span class="o">*</span>   <span class="nf">p2</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>  <span class="c1">//声明函数，返回int*
</span></span></span></code></pre></div><ul>
<li>赋值</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span> <span class="o">=</span> <span class="n">foo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">foo</span><span class="p">;</span>  <span class="c1">//效果一样
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>操作</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>      <span class="c1">//对应 int (*p)(int,int) = foo;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>   <span class="c1">//对应 int* p(int,int) = &amp;foo;
</span></span></span></code></pre></div><h3 id="使用">使用</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d+%d=%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%dx%d=%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//声明函数指针变量，并赋值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span> <span class="o">=</span> <span class="n">add</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">mul</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//通过函数指针调用函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">p1</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>       
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">)(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>   
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="作用">作用</h3>
<p>函数式编程（javascript, python,&hellip;.闭包等），C通过函数指针支持函数式编程，可以传递函数指针，返回函数指针</p>
<ul>
<li>
<p>编写一些非常通用的函数</p>
</li>
<li>
<p>分解任务，解耦合</p>
</li>
</ul>
<h3 id="例子qsort">例子（Qsort）：</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//通过qsort函数演示函数指针的应用
</span></span></span><span class="line"><span class="cl"><span class="c1">//可以对任意一个数组进行排序
</span></span></span><span class="line"><span class="cl"><span class="c1">//将元素从小到大进行排序
</span></span></span><span class="line"><span class="cl"><span class="c1">//base 指向起始地址
</span></span></span><span class="line"><span class="cl"><span class="c1">//memb 待排序的元素个数
</span></span></span><span class="line"><span class="cl"><span class="c1">//size 每个元素的大小
</span></span></span><span class="line"><span class="cl"><span class="c1">//compar 函数指针，类比strcmp进行理解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// void qsort(void* base, size_t nmemb, size_t size, int (*compar)(const void *, const void *));
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">gendar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">chinese</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">math</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">english</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">Student</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 封装比较规则：按总分从大到小排序
</span></span></span><span class="line"><span class="cl"><span class="c1">// 如果总分相同，按语数外的成绩从大到小排序
</span></span></span><span class="line"><span class="cl"><span class="c1">// 如果各科成绩都一样，再按ID从小到大排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//若返回值小于0，则认为p1&lt;p2, 
</span></span></span><span class="line"><span class="cl"><span class="c1">//若返回值等于0，则认为p1=p2, 
</span></span></span><span class="line"><span class="cl"><span class="c1">//若返回值大于0，则认为p1&gt;p2, 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">cmp</span><span class="p">(</span><span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">p2</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//指定通用指针的类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Student</span><span class="o">*</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Student</span><span class="o">*</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">p2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">total1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="o">+</span><span class="n">s1</span><span class="o">-&gt;</span><span class="n">math</span><span class="o">+</span><span class="n">s1</span><span class="o">-&gt;</span><span class="n">english</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">total2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="o">+</span><span class="n">s2</span><span class="o">-&gt;</span><span class="n">math</span><span class="o">+</span><span class="n">s2</span><span class="o">-&gt;</span><span class="n">english</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">total1</span><span class="o">!=</span><span class="n">total2</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">total2</span> <span class="o">-</span> <span class="n">total1</span><span class="p">;</span>  <span class="c1">//总分越高越靠后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">s1</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="o">!=</span><span class="n">s2</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">s2</span><span class="o">-&gt;</span><span class="n">chinese</span> <span class="o">-</span> <span class="n">s1</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">s1</span><span class="o">-&gt;</span><span class="n">math</span><span class="o">!=</span><span class="n">s2</span><span class="o">-&gt;</span><span class="n">math</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">s2</span><span class="o">-&gt;</span><span class="n">math</span> <span class="o">-</span> <span class="n">s1</span><span class="o">-&gt;</span><span class="n">math</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">s1</span><span class="o">-&gt;</span><span class="n">english</span><span class="o">!=</span><span class="n">s2</span><span class="o">-&gt;</span><span class="n">english</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">s2</span><span class="o">-&gt;</span><span class="n">english</span> <span class="o">-</span> <span class="n">s1</span><span class="o">-&gt;</span><span class="n">english</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s1</span> <span class="o">-&gt;</span> <span class="o">-</span> <span class="n">s2</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">print_stu_info</span><span class="p">(</span><span class="k">const</span> <span class="o">&amp;</span><span class="n">Student</span><span class="o">*</span> <span class="n">s</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d %s %c %d %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">s</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">s</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">s</span><span class="o">-&gt;</span><span class="n">gendar</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">s</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">s</span><span class="o">-&gt;</span><span class="n">math</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">s</span><span class="o">-&gt;</span><span class="n">english</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">Student</span> <span class="n">students</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//从键盘录入信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d%s %c%d%d&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="o">&amp;</span><span class="n">students</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">students</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="o">&amp;</span><span class="n">students</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">gendar</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="o">&amp;</span><span class="n">students</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">chinese</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="o">&amp;</span><span class="n">students</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">math</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="o">&amp;</span><span class="n">students</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">english</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">//从小到大排序
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">qsort</span><span class="p">(</span><span class="n">students</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Student</span><span class="p">),</span><span class="n">cmp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;------------------&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf_stu_info</span><span class="p">(</span><span class="o">&amp;</span><span class="n">student</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="总结">总结</h3>
<p>函数式编程的过程</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>qsort<span class="o">()</span> 函数<span class="o">]</span>&lt;-------&gt;<span class="o">[</span>cmp<span class="o">()</span> 函数<span class="o">]</span>
</span></span><span class="line"><span class="cl">               函数指针   钩子函数
</span></span></code></pre></div><p>qsort 通过函数指针调用用户修改好的cmp()函数，分解任务和解耦合</p>
<p>追求了高内聚低耦合的特性</p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://looechao.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://looechao.github.io/css/toc.css' />


<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://looechao.github.io/css/gitalk.css'>
<script src='https://looechao.github.io/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    clientID: '4fad9f9325f73f2c2891',
    clientSecret: '109ed02ced3608e776a41f87de4ef9986f5b5fd6',
    repo: 'hugo-comments',
    owner: 'looechao',
    admin: ['looechao'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>


  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://looechao.github.io/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://looechao.github.io/js/github-style.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"
  integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"
  integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"
  integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>





</html>